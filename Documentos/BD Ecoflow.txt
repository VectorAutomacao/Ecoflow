
Create Table grupo (
    id int not NULL,
    nome varchar(32) NOT NULL,
    CONSTRAINT grupo_pkey PRIMARY KEY (id)
);

Create Table planta (
    idecoflow int not NULL,
    id_grupo_fk int NOT NULL,    
    nome varchar(32) NOT NULL,
    CONSTRAINT grupo_fk FOREIGN KEY (id_grupo_fk)REFERENCES grupo(id),
    CONSTRAINT planta_pkey PRIMARY KEY (idecoflow)
);

Create Table unidade (
    idecoflow int not NULL,
    tempo date NOT NULL,
    hora time NOT NULL,
    id_planta_fk int NOT NULL,
    nome varchar(20) NOT NULL,
    medidor varchar(20),
    servico tinyint(1),
    leitura float,
    CONSTRAINT fk_planta FOREIGN KEY (id_planta_fk)REFERENCES planta(idecoflow),
    CONSTRAINT pk_unidade PRIMARY KEY (idecoflow,tempo, hora)
);

Create Table usuario(
    login varchar(20),
    senha varchar(20) NOT NULL,
    id int NOT NULL,
    nome varchar(30),
    email varchar(40),
    tipo varchar(10),
    status varchar(15),
    CONSTRAINT login_pkey PRIMARY KEY (login) 
);

INSERT INTO `unidade`(`idecoflow`, `tempo`, `hora`, `id_planta_fk`, `nome`, `medidor`, `servico`, `leitura`) SELECT idecoflow, SUBSTRING(tempo, 1, 10), SUBSTRING(tempo, -8), id_planta_fk, nome, medidor, servico, leitura FROM unidades